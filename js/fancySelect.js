(function(){var a;a=window.jQuery||window.Zepto||window.$,a.fn.fancySelect=function(b){var c,d;return null==b&&(b={}),d=a.extend({forceiOS:!1,includeBlank:!1,optionTemplate:function(a){return a.text()},triggerTemplate:function(a){return a.text()}},b),c=!!navigator.userAgent.match(/iP(hone|od|ad)/i),this.each(function(){var b,e,f,g,h,i,j;if(g=a(this),!g.hasClass("fancified")&&"SELECT"===g[0].tagName)return g.addClass("fancified"),g.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0}),g.wrap('<div class="fancy-select">'),j=g.parent(),g.data("class")&&j.addClass(g.data("class")),j.append('<div class="trigger">'),c&&!d.forceiOS||j.append('<ul class="options">'),h=j.find(".trigger"),f=j.find(".options"),e=g.prop("disabled"),e&&j.addClass("disabled"),i=function(){var a;return a=d.triggerTemplate(g.find(":selected")),h.html(a)},g.on("blur.fs",function(){if(h.hasClass("open"))return setTimeout(function(){return h.trigger("close.fs")},120)}),h.on("close.fs",function(){return h.removeClass("open"),f.removeClass("open")}),h.on("click.fs",function(){var b,i;if(!e)if(h.toggleClass("open"),c&&!d.forceiOS){if(h.hasClass("open"))return g.focus()}else if(h.hasClass("open")&&(i=h.parent(),b=i.offsetParent(),i.offset().top+i.outerHeight()+f.outerHeight()+20>a(window).height()+a(window).scrollTop()?f.addClass("overflowing"):f.removeClass("overflowing")),f.toggleClass("open"),!c)return g.focus()}),g.on("enable",function(){return g.prop("disabled",!1),j.removeClass("disabled"),e=!1,b()}),g.on("disable",function(){return g.prop("disabled",!0),j.addClass("disabled"),e=!0}),g.on("change.fs",function(a){return a.originalEvent&&a.originalEvent.isTrusted?a.stopPropagation():i()}),g.on("keydown",function(a){var b,c,d;if(d=a.which,b=f.find(".hover"),b.removeClass("hover"),f.hasClass("open")){if(38===d?(a.preventDefault(),b.length&&b.index()>0?b.prev().addClass("hover"):f.find("li:last-child").addClass("hover")):40===d?(a.preventDefault(),b.length&&b.index()<f.find("li").length-1?b.next().addClass("hover"):f.find("li:first-child").addClass("hover")):27===d?(a.preventDefault(),h.trigger("click.fs")):13===d||32===d?(a.preventDefault(),b.trigger("click.fs")):9===d&&h.hasClass("open")&&h.trigger("close.fs"),c=f.find(".hover"),c.length)return f.scrollTop(0),f.scrollTop(c.position().top-12)}else if(13===d||32===d||38===d||40===d)return a.preventDefault(),h.trigger("click.fs")}),f.on("click.fs","li",function(b){var d;return d=a(this),g.val(d.data("raw-value")),c||g.trigger("blur.fs").trigger("focus.fs"),f.find(".selected").removeClass("selected"),d.addClass("selected"),g.val(d.data("raw-value")).trigger("change.fs").trigger("blur.fs").trigger("focus.fs")}),f.on("mouseenter.fs","li",function(){var b,c;return c=a(this),b=f.find(".hover"),b.removeClass("hover"),c.addClass("hover")}),f.on("mouseleave.fs","li",function(){return f.find(".hover").removeClass("hover")}),b=function(){var b;if(i(),!c||d.forceiOS)return b=g.find("option"),g.find("option").each(function(b,c){var e;if(c=a(c),!c.prop("disabled")&&(c.val()||d.includeBlank))return e=d.optionTemplate(c),c.prop("selected")?f.append('<li data-raw-value="'+c.val()+'" class="selected">'+e+"</li>"):f.append('<li data-raw-value="'+c.val()+'">'+e+"</li>")})},g.on("update.fs",function(){return j.find(".options").empty(),b()}),b()})}}).call(this);